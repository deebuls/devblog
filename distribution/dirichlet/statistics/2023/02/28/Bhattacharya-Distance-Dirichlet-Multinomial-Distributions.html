<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Bhattacharya Distance: Dirichlet and Multinomial distribution</h1><p class="page-description">Derivation and Code</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-02-28T00:00:00-06:00" itemprop="datePublished">
        Feb 28, 2023
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Deebul Nair</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      12 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/devblog/categories/#distribution">distribution</a>
        &nbsp;
      
        <a class="category-tags-link" href="/devblog/categories/#dirichlet">dirichlet</a>
        &nbsp;
      
        <a class="category-tags-link" href="/devblog/categories/#statistics">statistics</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/deebuls/devblog/tree/master/_notebooks/2023-02-28-Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/devblog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/deebuls/devblog/master?filepath=_notebooks%2F2023-02-28-Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/devblog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/deebuls/devblog/blob/master/_notebooks/2023-02-28-Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/devblog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Logarthmic-form-of-Bhattachrya-distance-between-Dirichlet-densities">Logarthmic form of Bhattachrya distance between Dirichlet densities </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Equation-from-[1]">Equation from [1] </a></li>
<li class="toc-entry toc-h2"><a href="#Same-Equation-from-[2]">Same Equation from [2] </a></li>
<li class="toc-entry toc-h2"><a href="#Test-1:-Minimum-distance-for-different-number-of-alphas">Test 1: Minimum distance for different number of alphas </a></li>
<li class="toc-entry toc-h2"><a href="#Test-2:-With-high-values-of-alpha-effect-on-distance">Test 2: With high values of alpha effect on distance </a></li>
<li class="toc-entry toc-h2"><a href="#Test-3:-More-confident-value-distance-increases">Test 3: More confident value distance increases </a></li>
<li class="toc-entry toc-h2"><a href="#Test-4:-Distance-between-single-confident-class">Test 4: Distance between single confident class </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#Bhattacharya-Distance-Multinomial-Distirbution">Bhattacharya Distance Multinomial Distirbution </a></li>
<li class="toc-entry toc-h1"><a href="#End-of-Blog">End of Blog </a></li>
<li class="toc-entry toc-h1"><a href="#Trial-codes-not-working">Trial codes not working </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-02-28-Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/deebuls/devblog/blob/master/_notebooks/2023-02-28-Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Logarthmic-form-of-Bhattachrya-distance-between-Dirichlet-densities">
<a class="anchor" href="#Logarthmic-form-of-Bhattachrya-distance-between-Dirichlet-densities" aria-hidden="true"><span class="octicon octicon-link"></span></a>Logarthmic form of Bhattachrya distance between Dirichlet densities<a class="anchor-link" href="#Logarthmic-form-of-Bhattachrya-distance-between-Dirichlet-densities"> </a>
</h1>
<ul>
<li>
<p>[1] T. W. Rauber, A. Conci, T. Braun and K. Berns, "Bhattacharyya probabilistic distance of the Dirichlet density and its application to Split-and-Merge image segmentation," 2008 15th International Conference on Systems, Signals and Image Processing, Bratislava, Slovakia, 2008, pp. 145-148, doi: 10.1109/IWSSIP.2008.4604388.</p>
</li>
<li>
<p>[2] Nielsen, Frank and Richard Nock. “Cumulant-free closed-form formulas for some common (dis)similarities between densities of an exponential family.” ArXiv abs/2003.02469 (2020): n. page 12</p>
</li>
</ul>
<h2 id="Equation-from-[1]">
<a class="anchor" href="#Equation-from-%5B1%5D" aria-hidden="true"><span class="octicon octicon-link"></span></a>Equation from [1]<a class="anchor-link" href="#Equation-from-%5B1%5D"> </a>
</h2>$$ 
\eqalignno{ 
  &amp; \qquad B(\alpha_{a},\alpha_{b}) = -ln\rho(\alpha_{a},\alpha_{b})\cr 
  &amp; \quad=- ln\Gamma( \sum_{k=1}^{d}{\alpha_{ak}+\alpha_{bk}\over 2}) 
   + {1\over 2}\{\sum_{k=1}^{d}ln \Gamma(\alpha_{ak})+ \sum_{k=1}^{d}ln \Gamma(\alpha_{bk})\} 
   - \sum_{k=1}^{d}ln \Gamma({\alpha_{ak}+\alpha_{bk}\over 2}) 
   - {1\over 2} \{ ln \Gamma(\vert \alpha_{a}\vert)+ln\Gamma(\vert\alpha_{b}\vert \}
}
$$<h2 id="Same-Equation-from-[2]">
<a class="anchor" href="#Same-Equation-from-%5B2%5D" aria-hidden="true"><span class="octicon octicon-link"></span></a>Same Equation from [2]<a class="anchor-link" href="#Same-Equation-from-%5B2%5D"> </a>
</h2>$$
B(\alpha,\beta) = B(\alpha) + B(\beta) - B(\alpha+\beta)
$$<p>where
$$
B(\alpha) = \sum\log\Gamma{\alpha} - \log \Gamma{\sum(\alpha)}
$$</p>
<p>Equation from [2] is easy to code and debung than [1] so we implemented it</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gammaln</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">digamma</span>

<span class="k">def</span> <span class="nf">logBalpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
  <span class="c1">#todo check if values are positive and above 1</span>
  <span class="k">return</span> <span class="n">logBalpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">logBalpha</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">-</span> <span class="n">logBalpha</span><span class="p">(</span><span class="n">alpha</span><span class="o">+</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span> <span class="nb">print</span> <span class="p">(</span><span class="n">logBalpha</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-inf
0.0
0.0
-0.6931471805599453
-1.791759469228055
-3.1780538303479458
-4.787491742782046
-6.579251212010101
-8.525161361065415
-10.60460290274525
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-1:-Minimum-distance-for-different-number-of-alphas">
<a class="anchor" href="#Test-1:-Minimum-distance-for-different-number-of-alphas" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test 1: Minimum distance for different number of alphas<a class="anchor-link" href="#Test-1:-Minimum-distance-for-different-number-of-alphas"> </a>
</h2>
<p>The minimum distance starts from 0 and reduces as number of classes increases.</p>
<p>If one class is confident then the distance between them will get lower than the no information class distance . See test 4 where for 5 classes the distance goes lower than 6.45 as seen below.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span> 
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1.] 0.0
2 [1. 1.] 1.791759469228055
3 [1. 1. 1.] 3.401197381662155
4 [1. 1. 1. 1.] 4.941642422609305
5 [1. 1. 1. 1. 1.] 6.445719819385578
6 [1. 1. 1. 1. 1. 1.] 7.927324360309795
7 [1. 1. 1. 1. 1. 1. 1.] 9.393661429103219
8 [1. 1. 1. 1. 1. 1. 1. 1.] 10.848948661710065
9 [1. 1. 1. 1. 1. 1. 1. 1. 1.] 12.295867644646389
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-2:-With-high-values-of-alpha-effect-on-distance">
<a class="anchor" href="#Test-2:-With-high-values-of-alpha-effect-on-distance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test 2: With high values of alpha effect on distance<a class="anchor-link" href="#Test-2:-With-high-values-of-alpha-effect-on-distance"> </a>
</h2>
<p>Here we observe that the distance between same alphas keeps on decreasing as the value of alphas keep increasing.</p>
<p>Higher the alpha lower the distance . Also negative distance</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1. 1. 1. 1. 1.] 6.445719819385578
11 [11. 11. 11. 11. 11.] 1.1255028731251286
21 [21. 21. 21. 21. 21.] -0.19370880228223086
31 [31. 31. 31. 31. 31.] -0.9818529925794337
41 [41. 41. 41. 41. 41.] -1.5457429140878958
51 [51. 51. 51. 51. 51.] -1.9851193053912084
61 [61. 61. 61. 61. 61.] -2.3451443271551398
71 [71. 71. 71. 71. 71.] -2.650141672341306
81 [81. 81. 81. 81. 81.] -2.914723500702621
91 [91. 91. 91. 91. 91.] -3.1483581907859843
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-3:-More-confident-value-distance-increases">
<a class="anchor" href="#Test-3:-More-confident-value-distance-increases" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test 3: More confident value distance increases<a class="anchor-link" href="#Test-3:-More-confident-value-distance-increases"> </a>
</h2>
<p>When 1 valu of alpha is increases to show confidence increase on 1 class the distance with respect to no information keeps increasing</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1. 1. 1. 1. 1.] [1. 1. 1. 1. 1.] 6.445719819385578
11 [1. 1. 1. 1. 1.] [11.  1.  1.  1.  1.] 8.572713901314495
21 [1. 1. 1. 1. 1.] [21.  1.  1.  1.  1.] 10.249733300984314
31 [1. 1. 1. 1. 1.] [31.  1.  1.  1.  1.] 11.438891683612685
41 [1. 1. 1. 1. 1.] [41.  1.  1.  1.  1.] 12.356846899935736
51 [1. 1. 1. 1. 1.] [51.  1.  1.  1.  1.] 13.10383713518198
61 [1. 1. 1. 1. 1.] [61.  1.  1.  1.  1.] 13.733421146565181
71 [1. 1. 1. 1. 1.] [71.  1.  1.  1.  1.] 14.277449847443624
81 [1. 1. 1. 1. 1.] [81.  1.  1.  1.  1.] 14.75637687058833
91 [1. 1. 1. 1. 1.] [91.  1.  1.  1.  1.] 15.18411005351209
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-4:-Distance-between-single-confident-class">
<a class="anchor" href="#Test-4:-Distance-between-single-confident-class" aria-hidden="true"><span class="octicon octicon-link"></span></a>Test 4: Distance between single confident class<a class="anchor-link" href="#Test-4:-Distance-between-single-confident-class"> </a>
</h2>
<p>As both the classes converge to same alpha values the distance reduces.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
  <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">91</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [91.  1.  1.  1.  1.] [1. 1. 1. 1. 1.] 15.18411005351209
11 [91.  1.  1.  1.  1.] [11.  1.  1.  1.  1.] 9.072449120087896
21 [91.  1.  1.  1.  1.] [21.  1.  1.  1.  1.] 7.434934213898558
31 [91.  1.  1.  1.  1.] [31.  1.  1.  1.  1.] 6.625978812347682
41 [91.  1.  1.  1.  1.] [41.  1.  1.  1.  1.] 6.165455265460906
51 [91.  1.  1.  1.  1.] [51.  1.  1.  1.  1.] 5.889528847642993
61 [91.  1.  1.  1.  1.] [61.  1.  1.  1.  1.] 5.7237287914577735
71 [91.  1.  1.  1.  1.] [71.  1.  1.  1.  1.] 5.628589843464567
81 [91.  1.  1.  1.  1.] [81.  1.  1.  1.  1.] 5.581062260628471
91 [91.  1.  1.  1.  1.] [91.  1.  1.  1.  1.] 5.566743973084726
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bhattacharya-Distance-Multinomial-Distirbution">
<a class="anchor" href="#Bhattacharya-Distance-Multinomial-Distirbution" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bhattacharya Distance Multinomial Distirbution<a class="anchor-link" href="#Bhattacharya-Distance-Multinomial-Distirbution"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bhattacharya_distiance_multinomial</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="n">p2</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">,</span> <span class="n">bhattacharya_distiance_multinomial</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1.] -0.0
2 [0.5 0.5] -0.0
3 [0.33333333 0.33333333 0.33333333] -0.0
4 [0.25 0.25 0.25 0.25] -0.0
5 [0.2 0.2 0.2 0.2 0.2] -0.0
6 [0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667] 1.1102230246251565e-16
7 [0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714] 2.2204460492503136e-16
8 [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125] -0.0
9 [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111] -2.2204460492503128e-16
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span> <span class="p">)</span><span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">bhattacharya_distiance_multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [0.2 0.2 0.2 0.2 0.2] -0.0
11 [0.2 0.2 0.2 0.2 0.2] -0.0
21 [0.2 0.2 0.2 0.2 0.2] -0.0
31 [0.2 0.2 0.2 0.2 0.2] -0.0
41 [0.2 0.2 0.2 0.2 0.2] -0.0
51 [0.2 0.2 0.2 0.2 0.2] -0.0
61 [0.2 0.2 0.2 0.2 0.2] -0.0
71 [0.2 0.2 0.2 0.2 0.2] -0.0
81 [0.2 0.2 0.2 0.2 0.2] -0.0
91 [0.2 0.2 0.2 0.2 0.2] -0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span><span class="o">/</span><span class="mi">5</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">bhattacharya_distiance_multinomial</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [0.2 0.2 0.2 0.2 0.2] [0.2 0.2 0.2 0.2 0.2] -0.0
11 [0.2 0.2 0.2 0.2 0.2] [0.73333333 0.06666667 0.06666667 0.06666667 0.06666667] 0.1685949293453037
21 [0.2 0.2 0.2 0.2 0.2] [0.84 0.04 0.04 0.04 0.04] 0.26442280265424684
31 [0.2 0.2 0.2 0.2 0.2] [0.88571429 0.02857143 0.02857143 0.02857143 0.02857143] 0.32399341768738754
41 [0.2 0.2 0.2 0.2 0.2] [0.91111111 0.02222222 0.02222222 0.02222222 0.02222222] 0.36594403262269887
51 [0.2 0.2 0.2 0.2 0.2] [0.92727273 0.01818182 0.01818182 0.01818182 0.01818182] 0.3977150973709143
61 [0.2 0.2 0.2 0.2 0.2] [0.93846154 0.01538462 0.01538462 0.01538462 0.01538462] 0.4229448201200781
71 [0.2 0.2 0.2 0.2 0.2] [0.94666667 0.01333333 0.01333333 0.01333333 0.01333333] 0.44365990820723616
81 [0.2 0.2 0.2 0.2 0.2] [0.95294118 0.01176471 0.01176471 0.01176471 0.01176471] 0.46109522700067157
91 [0.2 0.2 0.2 0.2 0.2] [0.95789474 0.01052632 0.01052632 0.01052632 0.01052632] 0.47605403848305355
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="End-of-Blog">
<a class="anchor" href="#End-of-Blog" aria-hidden="true"><span class="octicon octicon-link"></span></a>End of Blog<a class="anchor-link" href="#End-of-Blog"> </a>
</h1>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Trial-codes-not-working">
<a class="anchor" href="#Trial-codes-not-working" aria-hidden="true"><span class="octicon octicon-link"></span></a>Trial codes not working<a class="anchor-link" href="#Trial-codes-not-working"> </a>
</h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="o">-</span><span class="n">gammaln</span><span class="p">(((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>


<span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span>

<span class="o">-</span><span class="n">gammaln</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="o">-</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-154.38281063467164
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-12.918839126312893</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="o">-</span><span class="n">gammaln</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">)))</span>


<span class="nb">print</span> <span class="p">((</span><span class="n">gammaln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="o">-</span><span class="n">gammaln</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="nb">print</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-154.38281063467164
179.5671026847877
-146.51925549072064
[-179.56710268   -0.           -0.        ]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gammaln</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">digamma</span>

<span class="k">def</span> <span class="nf">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,):</span>

  <span class="c1">#return -np.log2(sum(np.add(alpha, beta)/2)) + \</span>
  <span class="c1">#        0.5*sum(np.log2(alpha)) + 0.5*sum(np.log2(beta)) - \</span>
  <span class="c1">#        sum(np.log2(np.add(alpha, beta) / 2)) - \</span>
  <span class="c1">#        0.5 * np.log2(alpha).sum() + \</span>
  <span class="c1">#       0.5 * np.log2(beta).sum()</span>

  <span class="c1">#return  - gammaln(sum(np.add(alpha, beta)/2)) + \</span>
  <span class="c1">#  0.5*(sum(gammaln(alpha)) + sum(gammaln(beta))) - \</span>
  <span class="c1">#  sum(gammaln(np.add(alpha, beta) / 2)) -  \</span>
  <span class="c1">#  0.5*(gammaln(alpha).sum() + gammaln(beta).sum())</span>

  <span class="k">return</span> <span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> \
         <span class="n">gammaln</span><span class="p">((</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> \
         <span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-124-8efb0820f155&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> a2 <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> 
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span>bhattacharya_distance_dirichlet<span class="ansi-blue-fg">(</span>a1<span class="ansi-blue-fg">,</span> a2<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-123-aa14d3c37007&gt;</span> in <span class="ansi-cyan-fg">bhattacharya_distance_dirichlet</span><span class="ansi-blue-fg">(alpha, beta)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> 
<span class="ansi-green-intense-fg ansi-bold">     18</span>   <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>gammaln<span class="ansi-blue-fg">(</span>alpha<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> gammaln<span class="ansi-blue-fg">(</span>beta<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">/</span><span class="ansi-cyan-fg">2</span> <span class="ansi-blue-fg">-</span><span class="ansi-red-fg"> </span><span class="ansi-red-fg">\</span>
<span class="ansi-green-fg">---&gt; 19</span><span class="ansi-red-fg">          </span>gammaln<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>alpha <span class="ansi-blue-fg">+</span> beta <span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">/</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span><span class="ansi-red-fg"> </span><span class="ansi-red-fg">\</span>
<span class="ansi-green-intense-fg ansi-bold">     20</span>          <span class="ansi-blue-fg">(</span>gammaln<span class="ansi-blue-fg">(</span>alpha<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> gammaln<span class="ansi-blue-fg">(</span>beta<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">/</span><span class="ansi-cyan-fg">2</span>

<span class="ansi-red-fg">TypeError</span>: unsupported operand type(s) for /: 'list' and 'int'</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1.] [0.]
2 [1. 1.] [0. 0.]
3 [1. 1. 1.] [0. 0. 0.]
4 [1. 1. 1. 1.] [0. 0. 0. 0.]
5 [1. 1. 1. 1. 1.] [0. 0. 0. 0. 0.]
6 [1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0.]
7 [1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0.]
8 [1. 1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0. 0.]
9 [1. 1. 1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">bhattacharya_distance_dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1. 1. 1. 1. 1.] [0. 0. 0. 0. 0.]
11 [11. 11. 11. 11. 11.] [-15.10441257 -15.10441257 -15.10441257 -15.10441257 -15.10441257]
21 [21. 21. 21. 21. 21.] [-42.33561646 -42.33561646 -42.33561646 -42.33561646 -42.33561646]
31 [31. 31. 31. 31. 31.] [-74.65823635 -74.65823635 -74.65823635 -74.65823635 -74.65823635]
41 [41. 41. 41. 41. 41.] [-110.32063971 -110.32063971 -110.32063971 -110.32063971 -110.32063971]
51 [51. 51. 51. 51. 51.] [-148.47776695 -148.47776695 -148.47776695 -148.47776695 -148.47776695]
61 [61. 61. 61. 61. 61.] [-188.62817342 -188.62817342 -188.62817342 -188.62817342 -188.62817342]
71 [71. 71. 71. 71. 71.] [-230.43904357 -230.43904357 -230.43904357 -230.43904357 -230.43904357]
81 [81. 81. 81. 81. 81.] [-273.67312429 -273.67312429 -273.67312429 -273.67312429 -273.67312429]
91 [91. 91. 91. 91. 91.] [-318.15263962 -318.15263962 -318.15263962 -318.15263962 -318.15263962]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> 
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gammaln</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">digamma</span>

<span class="k">def</span> <span class="nf">KL_divergence</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">gammaln</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">-</span> \
        <span class="n">gammaln</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> <span class="o">-</span> \
        <span class="nb">sum</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">+</span> \
        <span class="nb">sum</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span> <span class="o">+</span>  \
        <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">digamma</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">digamma</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">KL_divergence</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1.] [0.]
2 [1. 1.] [0. 0.]
3 [1. 1. 1.] [0. 0. 0.]
4 [1. 1. 1. 1.] [0. 0. 0. 0.]
5 [1. 1. 1. 1. 1.] [0. 0. 0. 0. 0.]
6 [1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0.]
7 [1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0.]
8 [1. 1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0. 0.]
9 [1. 1. 1. 1. 1. 1. 1. 1. 1.] [0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">KL_divergence</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1. 1. 1. 1. 1.] [0. 0. 0. 0. 0.]
11 [11. 11. 11. 11. 11.] [0. 0. 0. 0. 0.]
21 [21. 21. 21. 21. 21.] [0. 0. 0. 0. 0.]
31 [31. 31. 31. 31. 31.] [0. 0. 0. 0. 0.]
41 [41. 41. 41. 41. 41.] [0. 0. 0. 0. 0.]
51 [51. 51. 51. 51. 51.] [0. 0. 0. 0. 0.]
61 [61. 61. 61. 61. 61.] [0. 0. 0. 0. 0.]
71 [71. 71. 71. 71. 71.] [0. 0. 0. 0. 0.]
81 [81. 81. 81. 81. 81.] [0. 0. 0. 0. 0.]
91 [91. 91. 91. 91. 91.] [0. 0. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-11-4addd521ddf1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>scipy<span class="ansi-blue-fg">.</span>special<span class="ansi-blue-fg">.</span>digamma

<span class="ansi-red-fg">AttributeError</span>: module 'scipy' has no attribute 'special'</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span>

<span class="n">bhattacharya_distiance_multinomial</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-0.0</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bhattacharya_distiance_multinomial_log</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>

  <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">bhattacharya_distiance_multinomial_log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [1.] -0.0
2 [1. 1.] -0.0
3 [1. 1. 1.] -0.0
4 [1. 1. 1. 1.] -0.0
5 [1. 1. 1. 1. 1.] -0.0
6 [1. 1. 1. 1. 1. 1.] -0.0
7 [1. 1. 1. 1. 1. 1. 1.] -0.0
8 [1. 1. 1. 1. 1. 1. 1. 1.] -0.0
9 [1. 1. 1. 1. 1. 1. 1. 1. 1.] -0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
  <span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span><span class="o">/</span><span class="mi">5</span>
  <span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">bhattacharya_distiance_multinomial_log</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1 [0.2 0.2 0.2 0.2 0.2] [0.2 0.2 0.2 0.2 0.2] -7.620319112153923
11 [0.2 0.2 0.2 0.2 0.2] [0.73333333 0.06666667 0.06666667 0.06666667 0.06666667] -9.26724932985341
21 [0.2 0.2 0.2 0.2 0.2] [0.84 0.04 0.04 0.04 0.04] -10.261942523017305
31 [0.2 0.2 0.2 0.2 0.2] [0.88571429 0.02857143 0.02857143 0.02857143 0.02857143] -10.927875722571079
41 [0.2 0.2 0.2 0.2 0.2] [0.91111111 0.02222222 0.02222222 0.02222222 0.02222222] -11.427687210720562
51 [0.2 0.2 0.2 0.2 0.2] [0.92727273 0.01818182 0.01818182 0.01818182 0.01818182] -11.827621143269788
61 [0.2 0.2 0.2 0.2 0.2] [0.93846154 0.01538462 0.01538462 0.01538462 0.01538462] -12.160926600816564
71 [0.2 0.2 0.2 0.2 0.2] [0.94666667 0.01333333 0.01333333 0.01333333 0.01333333] -12.44662759830056
81 [0.2 0.2 0.2 0.2 0.2] [0.95294118 0.01176471 0.01176471 0.01176471 0.01176471] -12.6966207038721
91 [0.2 0.2 0.2 0.2 0.2] [0.95789474 0.01052632 0.01052632 0.01052632 0.01052632] -12.918839126312893
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="k">def</span> <span class="nf">bhattacharyya_distance</span><span class="p">(</span><span class="n">repr1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">repr2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">"""Calculates Bhattacharyya distance (https://en.wikipedia.org/wiki/Bhattacharyya_distance)."""</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">repr1</span><span class="p">,</span> <span class="n">repr2</span><span class="p">)])</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">,</span> <span class="n">bhattacharyya_distance</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">i</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.0
1 [1.] -0.0
1.0
2 [0.5 0.5] -0.0
1.0
3 [0.33333333 0.33333333 0.33333333] -0.0
1.0
4 [0.25 0.25 0.25 0.25] -0.0
1.0
5 [0.2 0.2 0.2 0.2 0.2] -0.0
0.9999999999999999
6 [0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667] 1.1102230246251565e-16
0.9999999999999998
7 [0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714] 2.2204460492503136e-16
1.0
8 [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125] -0.0
1.0
9 [0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111] -0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="n">p1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.2, 0.2, 0.2, 0.2, 0.2])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/devblog/distribution/dirichlet/statistics/2023/02/28/Bhattacharya-Distance-Dirichlet-Multinomial-Distributions.html" hidden></a>
</article>