<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Migrating Kelo Tulip to ROS2</h1><p class="page-description">Migrating Kelo Tulip to ROS2</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-01-13T00:00:00-06:00" itemprop="datePublished">
        Jan 13, 2023
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/devblog/categories/#robotics">robotics</a>
        &nbsp;
      
        <a class="category-tags-link" href="/devblog/categories/#ros2">ros2</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#migration-of-ros2">Migration of ROS2</a>
<ul>
<li class="toc-entry toc-h2"><a href="#errors">Errors</a></li>
</ul>
</li>
</ul><h1 id="migration-of-ros2">
<a class="anchor" href="#migration-of-ros2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Migration of ROS2</h1>

<ol>
  <li>As per the blog the migration steps are (ROS2 migration guide)[https://docs.ros.org/en/foxy/The-ROS2-Project/Contributing/Migration-Guide.html]
    <ul>
      <li>Package manifests</li>
      <li>Metapackages</li>
      <li>Message, service, and action definitions</li>
      <li>Build system</li>
      <li>Update source code</li>
    </ul>
  </li>
  <li>
    <p>Step 1 : Package manifests</p>
  </li>
  <li>Migration Gazebo
    <ul>
      <li>https://github.com/ros-simulation/gazebo_ros_pkgs/wiki</li>
    </ul>
  </li>
  <li>Messages
    <ul>
      <li>For messages and services replace the message using the formulation below</li>
      <li>
<code class="highlighter-rouge">#include &lt;sensor_msgs/JointState.hpp&gt;</code> ➡️ <code class="highlighter-rouge">#include &lt;sensor_msgs/msg/joint_state.hpp&gt;</code>
</li>
      <li>
<code class="highlighter-rouge">#include &lt;nav_msgs/Odometry.hpp&gt;</code> ➡️ <code class="highlighter-rouge">#include &lt;nav_msgs/msg/odometry.hpp&gt;</code>
</li>
      <li>You add the msg and in small letters</li>
    </ul>
  </li>
  <li>Main.cpp
    <ul>
      <li>
<code class="highlighter-rouge">#include "ros/ros.h" </code> ▶️ <code class="highlighter-rouge">#include "rclcpp/rclcpp.hpp"</code>
</li>
    </ul>
  </li>
  <li>Launching robot in Gazebo : Error model visalization
```
For ROS2 usage, by changing the following in any of the cameras’ urdf file</li>
</ol>
<mesh filename="package://realsense2_description/meshes/d415.stl"></mesh>

<p>into</p>
<mesh filename="file://$(find realsense2_description)/meshes/d415.stl"></mesh>

<p>will resolve the issue, as it will evaluate to the full path when xacro generates the URDF.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
8. Adding laser scanner in gazebo . Errors
    * Used the xacro method from ros1 
    * xacro method works but plugins have changed 
    * libgazebo_ros_laser.so is now changed to ➡️ libgazebo_ros_ray_sensor.so
    * Also the paraeter to initialize it is different 
    * Check the github [issue](https://github.com/ros-simulation/gazebo_ros_pkgs/issues/1266#issuecomment-826249858) for proper initialization
    * 
9. Ros2 node with both cpp and python then do the following 
 
    * I have a mixed C++/Python package. To install a Python executable in this package, I've found it sufficient to do this:
    * Add the Python source file to my_package/scripts
    * Add this line at the top of ^that file: #!/usr/bin/env python3
    * Make it executable with chmod +x
    * Add an empty __init__.py file in my_package/scripts
    * Add this to CMakeLists:
</code></pre></div></div>
<p>install(PROGRAMS<br>
  scripts/my_python_file.py<br>
  DESTINATION lib/${PROJECT_NAME} )</p>

<p>```
    * from https://answers.ros.org/question/299269/ros2-run-python-executable-not-found/</p>

<h2 id="errors">
<a class="anchor" href="#errors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Errors</h2>
<ol>
  <li>Starting gazebo in the launch file gives “camera assertion error “
    <ul>
      <li>The solution is to source Gazebo’s setup file, i.e.: <code class="highlighter-rouge">. /usr/share/gazebo/setup.sh</code>
</li>
      <li>https://answers.gazebosim.org//question/28066/is-libgazebo_ros_multicameraso-deprecated/</li>
      <li>
<code class="highlighter-rouge">echo "source /usr/share/gazebo/setup.bash" &gt;&gt; ~/.bashrc</code> ▶️ for persistence</li>
    </ul>
  </li>
</ol>

  </div><a class="u-url" href="/devblog/robotics/ros2/2023/01/13/Migration-ROS-Kelo-Tulip-ROS2.html" hidden></a>
</article>